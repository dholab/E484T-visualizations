points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 54, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
matrix.layout<-matrix(c(1,1,1,2,1,1,1,2),nrow=2,byrow = TRUE)
matrix.layout
layout(matrix.layout)
# layout.show(2)
par(mar=c(5.1,4.1,4.1,2.1))
{plot(1,1, xlim = c(0,30000), ylim=c(0, 350), type = "n",
xlab = "SARS-CoV-2 Genome Position", ylab = "Day of Infection",
frame.plot = F, cex.axis = 0.8, las = 1, xaxt = "n")
axis(side = 1, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black")
segments(x0=SARS_genes$stop,
y0 = rep(-10, times = length(SARS_genes$stop)),
y1 = rep(350, times = length(SARS_genes$stop)),
col = "lightgrey")
segments(x0 = SARS_genes$start[1], y0 = -10, y1 = 350, col = "lightgrey")
for (i in 1:nrow(SARS_genes)){
polygon(x = c(SARS_genes[i,"start"], SARS_genes[i,"start"],
SARS_genes[i,"stop"], SARS_genes[i,"stop"]),  # coordinates of gene
y = c(-9.5, 20, 20, -9.5),    # Y-Coordinates of polygon
col = SARS_genes[i,"col"], border = F)
text(x = SARS_genes[i,"start"] + (SARS_genes[i,"stop"]-SARS_genes[i,"start"])/2,
y = (20--9.5)/4, labels = SARS_genes[i, "name"], col = "black", cex = 0.8)
}
for (i in 1:length(mut_list2)){
plotting_data <- data.frame("Date" = mut_list2[[i]],
"Coordinate" = rep(as.numeric(names(mut_list2)[i]), times = length(mut_list2[[i]])))
points(x = plotting_data$Coordinate, plotting_data$Date, type = "p", pch = 20, col = "#e5e5e5")
}
fixed <- rep(NA, times = length(mut_list2))
for (i in 1:length(fixed)){
fixed[i] <- length(mut_list2[[i]])==6
}
segments(x0 = -1200, x1 = 29800, y0=198, col = "red", lty = 2)
# text(x = 29500, y = 210, labels = "Bamlanivumab administered", cex = 0.8, las = 3)
points(crude_vcf[!fixed, "POS"], crude_vcf[!fixed, "EARLIEST_DAY"], pch = 16, col = "#7e7e7e", cex = 1.2)
points(23012, crude_vcf[crude_vcf$POS==23012,"EARLIEST_DAY"],
pch = 1, cex = 2, col = "gold")
text(23000, 320, labels = "E484T", col = "#7e7e7e", cex = 0.8)
legend(15000,400, legend=c("fixed mutation", "novel mutation", "antibody treatment"),
pch = c(20, 16, NA), lty = c(NA, NA, 1),
col = c("#e5e5e5", "#7e7e7e", "red"),
bty = "o", cex = 0.8, box.col = "white", ncol = 3, xpd = T, xjust = 0.5)
}
# PLOTTING DIVERGENCE ####
{par(mar=c(5.1,0,4.1,2.1))
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n")
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 53.5, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
dev.off()
# PLOTTING MUTATIONS ####
matrix.layout<-matrix(c(1,1,1,1,2,2),nrow=3,byrow = TRUE)
matrix.layout
layout(matrix.layout)
layout.show(2)
# PLOTTING MUTATIONS ####
matrix.layout<-matrix(c(1,1,1,1,1,1,2,2),nrow=4,byrow = TRUE)
matrix.layout
layout(matrix.layout)
layout.show(2)
{plot(1,1, ylim = c(0,30000), xlim=c(0, 350), type = "n",
ylab = "SARS-CoV-2 Genome Position", xlab = "Day of Infection",
frame.plot = F, cex.axis = 0.8, yaxt = "n")
axis(side = 2, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
segments(y0=SARS_genes$stop,
x0 = rep(-10, times = length(SARS_genes$stop)),
x1 = rep(350, times = length(SARS_genes$stop)),
col = "lightgrey")
segments(y0 = SARS_genes$start[1], x0 = -10, x1 = 350, col = "lightgrey")
for (i in 1:nrow(SARS_genes)){
polygon(y = c(SARS_genes[i,"start"], SARS_genes[i,"start"],
SARS_genes[i,"stop"], SARS_genes[i,"stop"]),  # coordinates of gene
x = c(-9.5, 20, 20, -9.5),    # Y-Coordinates of polygon
col = SARS_genes[i,"col"], border = F)
text(y = SARS_genes[i,"start"] + (SARS_genes[i,"stop"]-SARS_genes[i,"start"])/2,
x = (20--9.5)/4, labels = SARS_genes[i, "name"], col = "black", cex = 0.8)
}
for (i in 1:length(mut_list2)){
plotting_data <- data.frame("Date" = mut_list2[[i]],
"Coordinate" = rep(as.numeric(names(mut_list2)[i]), times = length(mut_list2[[i]])))
points(y = plotting_data$Coordinate, x = plotting_data$Date, type = "p", pch = 20, col = "#e5e5e5")
}
fixed <- rep(NA, times = length(mut_list2))
for (i in 1:length(fixed)){
fixed[i] <- length(mut_list2[[i]])==6
}
segments(y0 = -1200, y1 = 29800, x0=198, col = "red")
# text(x = 29500, y = 210, labels = "Bamlanivumab administered", cex = 0.8, las = 3)
points(y = crude_vcf[!fixed, "POS"], x = crude_vcf[!fixed, "EARLIEST_DAY"], pch = 16, col = "#7e7e7e", cex = 1.2)
points(y = 23012, x = crude_vcf[crude_vcf$POS==23012,"EARLIEST_DAY"],
pch = 1, cex = 2, col = "gold")
text(y = 23000, x = 315, labels = "E484T", col = "#7e7e7e", cex = 0.8)
legend(175, 34000, legend=c("fixed mutation", "novel mutation", "antibody treatment"),
pch = c(20, 16, NA), lty = c(NA, NA, 1),
col = c("#e5e5e5", "#7e7e7e", "red"),
bty = "o", cex = 0.8, box.col = "white", ncol = 3, xpd = T, xjust = 0.5)
}
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n")
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 53.5, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
par()$mar
matrix.layout<-matrix(c(1,1,1,1,1,1,2,2),nrow=4,byrow = TRUE)
matrix.layout
layout(matrix.layout)
# layout.show(2)
par(mar=c(5.1, 4.1, 4.1, 2.1))
{plot(1,1, ylim = c(0,30000), xlim=c(0, 350), type = "n",
ylab = "SARS-CoV-2 Genome Position", xlab = "Day of Infection",
frame.plot = F, cex.axis = 0.8, yaxt = "n")
axis(side = 2, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
segments(y0=SARS_genes$stop,
x0 = rep(-10, times = length(SARS_genes$stop)),
x1 = rep(350, times = length(SARS_genes$stop)),
col = "lightgrey")
segments(y0 = SARS_genes$start[1], x0 = -10, x1 = 350, col = "lightgrey")
for (i in 1:nrow(SARS_genes)){
polygon(y = c(SARS_genes[i,"start"], SARS_genes[i,"start"],
SARS_genes[i,"stop"], SARS_genes[i,"stop"]),  # coordinates of gene
x = c(-9.5, 20, 20, -9.5),    # Y-Coordinates of polygon
col = SARS_genes[i,"col"], border = F)
text(y = SARS_genes[i,"start"] + (SARS_genes[i,"stop"]-SARS_genes[i,"start"])/2,
x = (20--9.5)/4, labels = SARS_genes[i, "name"], col = "black", cex = 0.8)
}
for (i in 1:length(mut_list2)){
plotting_data <- data.frame("Date" = mut_list2[[i]],
"Coordinate" = rep(as.numeric(names(mut_list2)[i]), times = length(mut_list2[[i]])))
points(y = plotting_data$Coordinate, x = plotting_data$Date, type = "p", pch = 20, col = "#e5e5e5")
}
fixed <- rep(NA, times = length(mut_list2))
for (i in 1:length(fixed)){
fixed[i] <- length(mut_list2[[i]])==6
}
segments(y0 = -1200, y1 = 29800, x0=198, col = "red")
# text(x = 29500, y = 210, labels = "Bamlanivumab administered", cex = 0.8, las = 3)
points(y = crude_vcf[!fixed, "POS"], x = crude_vcf[!fixed, "EARLIEST_DAY"], pch = 16, col = "#7e7e7e", cex = 1.2)
points(y = 23012, x = crude_vcf[crude_vcf$POS==23012,"EARLIEST_DAY"],
pch = 1, cex = 2, col = "gold")
text(y = 23000, x = 315, labels = "E484T", col = "#7e7e7e", cex = 0.8)
legend(175, 34000, legend=c("fixed mutation", "novel mutation", "antibody treatment"),
pch = c(20, 16, NA), lty = c(NA, NA, 1),
col = c("#e5e5e5", "#7e7e7e", "red"),
bty = "o", cex = 0.8, box.col = "white", ncol = 3, xpd = T, xjust = 0.5)
}
# PLOTTING DIVERGENCE ####
{par(mar=c(5.1,4.1,0,2.1))
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n")
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 53.5, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
dev.off()
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 2, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = "Day of Infection", ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = NA, ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 53.5, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
# PLOTTING DIVERGENCE ####
{par(mar=c(5.1,4.1,2,2.1))
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = NA, ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 53.5, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
legend(175, 22, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
matrix.layout<-matrix(c(1,1,1,1,1,1,2,2),nrow=4,byrow = TRUE)
matrix.layout
layout(matrix.layout)
# layout.show(2)
par(mar=c(5.1, 4.1, 4.1, 2.1))
{plot(1,1, ylim = c(0,30000), xlim=c(0, 350), type = "n",
ylab = "SARS-CoV-2 Genome Position", xlab = "Day of Infection",
frame.plot = F, cex.axis = 0.8, yaxt = "n")
axis(side = 2, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
segments(y0=SARS_genes$stop,
x0 = rep(-10, times = length(SARS_genes$stop)),
x1 = rep(350, times = length(SARS_genes$stop)),
col = "lightgrey")
segments(y0 = SARS_genes$start[1], x0 = -10, x1 = 350, col = "lightgrey")
for (i in 1:nrow(SARS_genes)){
polygon(y = c(SARS_genes[i,"start"], SARS_genes[i,"start"],
SARS_genes[i,"stop"], SARS_genes[i,"stop"]),  # coordinates of gene
x = c(-9.5, 20, 20, -9.5),    # Y-Coordinates of polygon
col = SARS_genes[i,"col"], border = F)
text(y = SARS_genes[i,"start"] + (SARS_genes[i,"stop"]-SARS_genes[i,"start"])/2,
x = (20--9.5)/4, labels = SARS_genes[i, "name"], col = "black", cex = 0.8)
}
for (i in 1:length(mut_list2)){
plotting_data <- data.frame("Date" = mut_list2[[i]],
"Coordinate" = rep(as.numeric(names(mut_list2)[i]), times = length(mut_list2[[i]])))
points(y = plotting_data$Coordinate, x = plotting_data$Date, type = "p", pch = 20, col = "#e5e5e5")
}
fixed <- rep(NA, times = length(mut_list2))
for (i in 1:length(fixed)){
fixed[i] <- length(mut_list2[[i]])==6
}
segments(y0 = -1200, y1 = 29800, x0=198, col = "red")
# text(x = 29500, y = 210, labels = "Bamlanivumab administered", cex = 0.8, las = 3)
points(y = crude_vcf[!fixed, "POS"], x = crude_vcf[!fixed, "EARLIEST_DAY"], pch = 16, col = "#7e7e7e", cex = 1.2)
points(y = 23012, x = crude_vcf[crude_vcf$POS==23012,"EARLIEST_DAY"],
pch = 1, cex = 2, col = "gold")
text(y = 23000, x = 315, labels = "E484T", col = "#7e7e7e", cex = 0.8)
legend(175, 34000, legend=c("fixed mutation", "novel mutation", "antibody treatment"),
pch = c(20, 16, NA), lty = c(NA, NA, 1),
col = c("#e5e5e5", "#7e7e7e", "red"),
bty = "o", cex = 0.8, box.col = "white", ncol = 3, xpd = T, xjust = 0.5)
}
# PLOTTING DIVERGENCE ####
{par(mar=c(5.1,4.1,2,2.1))
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = NA, ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 22, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
# PLOTTING MUTATIONS ####
matrix.layout<-matrix(c(1,1,1,1,2,2),nrow=3,byrow = TRUE)
matrix.layout
layout(matrix.layout)
# layout.show(2)
par(mar=c(5.1, 4.1, 4.1, 2.1))
{plot(1,1, ylim = c(0,30000), xlim=c(0, 350), type = "n",
ylab = "SARS-CoV-2 Genome Position", xlab = "Day of Infection",
frame.plot = F, cex.axis = 0.8, yaxt = "n")
axis(side = 2, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
segments(y0=SARS_genes$stop,
x0 = rep(-10, times = length(SARS_genes$stop)),
x1 = rep(350, times = length(SARS_genes$stop)),
col = "lightgrey")
segments(y0 = SARS_genes$start[1], x0 = -10, x1 = 350, col = "lightgrey")
for (i in 1:nrow(SARS_genes)){
polygon(y = c(SARS_genes[i,"start"], SARS_genes[i,"start"],
SARS_genes[i,"stop"], SARS_genes[i,"stop"]),  # coordinates of gene
x = c(-9.5, 20, 20, -9.5),    # Y-Coordinates of polygon
col = SARS_genes[i,"col"], border = F)
text(y = SARS_genes[i,"start"] + (SARS_genes[i,"stop"]-SARS_genes[i,"start"])/2,
x = (20--9.5)/4, labels = SARS_genes[i, "name"], col = "black", cex = 0.8)
}
for (i in 1:length(mut_list2)){
plotting_data <- data.frame("Date" = mut_list2[[i]],
"Coordinate" = rep(as.numeric(names(mut_list2)[i]), times = length(mut_list2[[i]])))
points(y = plotting_data$Coordinate, x = plotting_data$Date, type = "p", pch = 20, col = "#e5e5e5")
}
fixed <- rep(NA, times = length(mut_list2))
for (i in 1:length(fixed)){
fixed[i] <- length(mut_list2[[i]])==6
}
segments(y0 = -1200, y1 = 29800, x0=198, col = "red")
# text(x = 29500, y = 210, labels = "Bamlanivumab administered", cex = 0.8, las = 3)
points(y = crude_vcf[!fixed, "POS"], x = crude_vcf[!fixed, "EARLIEST_DAY"], pch = 16, col = "#7e7e7e", cex = 1.2)
points(y = 23012, x = crude_vcf[crude_vcf$POS==23012,"EARLIEST_DAY"],
pch = 1, cex = 2, col = "gold")
text(y = 23000, x = 315, labels = "E484T", col = "#7e7e7e", cex = 0.8)
legend(175, 34000, legend=c("fixed mutation", "novel mutation", "antibody treatment"),
pch = c(20, 16, NA), lty = c(NA, NA, 1),
col = c("#e5e5e5", "#7e7e7e", "red"),
bty = "o", cex = 0.8, box.col = "white", ncol = 3, xpd = T, xjust = 0.5)
}
# PLOTTING DIVERGENCE ####
{par(mar=c(5.1,4.1,2,2.1))
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = NA, ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 22, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
matrix.layout<-matrix(c(1,1,1,1,2,2),nrow=3,byrow = TRUE)
matrix.layout
layout(matrix.layout)
# layout.show(2)
par(mar=c(5.1, 4.1, 4.1, 2.1))
{plot(1,1, ylim = c(0,30000), xlim=c(0, 350), type = "n",
ylab = "SARS-CoV-2 Genome Position", xlab = "Day of Infection",
frame.plot = F, cex.axis = 0.8, yaxt = "n")
axis(side = 2, at = c(0,5000,10000,15000,20000,25000,30000), cex.axis = 0.8,
col = "white", col.ticks = "black", las = 1)
segments(y0=SARS_genes$stop,
x0 = rep(-10, times = length(SARS_genes$stop)),
x1 = rep(350, times = length(SARS_genes$stop)),
col = "lightgrey")
segments(y0 = SARS_genes$start[1], x0 = -10, x1 = 350, col = "lightgrey")
for (i in 1:nrow(SARS_genes)){
polygon(y = c(SARS_genes[i,"start"], SARS_genes[i,"start"],
SARS_genes[i,"stop"], SARS_genes[i,"stop"]),  # coordinates of gene
x = c(-9.5, 20, 20, -9.5),    # Y-Coordinates of polygon
col = SARS_genes[i,"col"], border = F)
text(y = SARS_genes[i,"start"] + (SARS_genes[i,"stop"]-SARS_genes[i,"start"])/2,
x = (20--9.5)/4, labels = SARS_genes[i, "name"], col = "black", cex = 0.8)
}
for (i in 1:length(mut_list2)){
plotting_data <- data.frame("Date" = mut_list2[[i]],
"Coordinate" = rep(as.numeric(names(mut_list2)[i]), times = length(mut_list2[[i]])))
points(y = plotting_data$Coordinate, x = plotting_data$Date, type = "p", pch = 20, col = "#e5e5e5")
}
fixed <- rep(NA, times = length(mut_list2))
for (i in 1:length(fixed)){
fixed[i] <- length(mut_list2[[i]])==6
}
segments(y0 = -1200, y1 = 29800, x0=198, col = "red")
# text(x = 29500, y = 210, labels = "Bamlanivumab administered", cex = 0.8, las = 3)
points(y = crude_vcf[!fixed, "POS"], x = crude_vcf[!fixed, "EARLIEST_DAY"], pch = 16, col = "#7e7e7e", cex = 1.2)
points(y = 23012, x = crude_vcf[crude_vcf$POS==23012,"EARLIEST_DAY"],
pch = 1, cex = 2, col = "gold")
text(y = 23000, x = 315, labels = "E484T", col = "#7e7e7e", cex = 0.8)
legend(175, 34000, legend=c("fixed mutation", "novel mutation", "antibody treatment"),
pch = c(20, 16, NA), lty = c(NA, NA, 1),
col = c("#e5e5e5", "#7e7e7e", "red"),
bty = "o", cex = 0.8, box.col = "white", ncol = 3, xpd = T, xjust = 0.5)
}
# PLOTTING DIVERGENCE ####
{par(mar=c(5.1,4.1,2,2.1))
set.seed(14)
simulation1 <- data.frame("distance" = rnorm(1000, 35, 5),
"day_of_infection" = rnorm(1000, 100, 100))
simulation2 <- data.frame("distance" = rnorm(1000, 40, 5),
"day_of_infection" = rnorm(1000, 200, 100))
simulation <- rbind(simulation1, simulation2)
simul_lm <- lm(simulation$distance ~ simulation$day_of_infection)
patient_lm <- lm(fasta_df$distance ~ fasta_df$day_of_infection)
plot(fasta_df$day_of_infection, fasta_df$distance, ylim = c(25, 50), xlim = c(0, 350),
xlab = NA, ylab = "Genetic Distance from Wuhan Variant", frame.plot = F,
cex.axis = 0.8, cex.lab = 0.85, las = 1, pch = 20, cex = 3, col = "#4B7395", type = "n", xaxt = "n")
axis(side = 3, at = c(0,50,100,150,200,250,300,350), cex.axis = 0.8,
col.ticks = "black", las = 1)
grid()
text(198, 45, labels = "Antibody\nTreatment", cex = 0.8, bty = "l")
segments(x0 = 198, y0 = 22, y1 = 43, col = "red", lty = 2)
segments(x0 = 198, y0 = 47, y1 = 51, col = "red", lty = 2)
points(simulation$day_of_infection, simulation$distance,
pch = 20, cex = 1, col = rgb(75/255,115/255,149/255,0.5))
abline(simul_lm, col = rgb(75/255,115/255,149/255,1), lwd = 4)
points(fasta_df$day_of_infection, fasta_df$distance,
pch = 20, cex = 2, col = rgb(227/255,152/255,58/255, 0.8))
abline(patient_lm, col = rgb(227/255,152/255,58/255,1), lwd = 4)
legend(175, 24, legend = c("US VOCs", "Patient Mutations"),
col = c(rgb(75/255,115/255,149/255,1), rgb(227/255,152/255,58/255,1)),
lwd = c(4,4), ncol = 2, xpd = T, xjust = 0.5, bty = "n", cex = 0.8)
}
source('~/.active-rstudio-document')
